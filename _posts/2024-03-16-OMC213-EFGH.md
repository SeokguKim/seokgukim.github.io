---
title: OMC213 E - F
layout: post
tags: [omc]
---
**대회 링크**  
<https://onlinemathcontest.com/contests/omc213>

### E

**문제**

\\(\angle A = 60^{\circ}\\)을 만족하는 삼각형 \\(ABC\\)의 내부에 점 \\(P\\)를 잡았을 때,

\\[BP + CP = AC, AB = CP\\]

가 성립했습니다. 삼각형 \\(ABC\\)의 넓이가 \\(4017\\), 삼각형 \\(PBC\\)의 넓이가 \\(1989\\)일 때, \\(CP\\)의 길이의 \\(4\\)제곱을 구하세요.

**해설**

변 \\(AC\\) 위에 \\(AB = AQ\\)를 만족하는 점 \\(Q\\)를 잡아봅시다.  
이 때, 삼각형 \\(ABQ\\)는 정삼각형이므로,

\\[QB = AB = PC, QC = AC - AB = AC - PC = PB\\]

가 각각 성립합니다.  
따라서 삼각형 \\(PBC\\)와 삼각형 \\(QCB\\)는 합동이므로,

\\[\triangle{ABQ} = \triangle{ABC} - \triangle{QCB} = \triangle{ABC} - \triangle{PBC} = 2028\\]

입니다.  
한편,

\\[\triangle{ABQ} = \frac{1}{2} BQ^2 \sin 60^{\circ} = \frac{\sqrt 3}{4}CP^2\\]

이므로 \\(\frac{\sqrt 3}{4}CP^2 = 2028\\). 따라서 \\(CP^4 = 21934848\\)입니다.

### F

**문제**

\\(a_1 = 3334, a_{n + 1} = 3a_n^2 - 4a_n + 2\ (n \geq 1)\\)로 정의되는 수열 \\(\\{a_n\\}\\)에 대해, \\(a_{3334}\\)는 양의 정수가 됩니다.  
이 때, \\(a_{3334}\\)의 각 자릿수의 합 \\(M\\)을 소수 \\(3331\\)로 나눈 나머지를 구하세요.

**해설**

\\(a_{n + 1} = 3a_n^2 - 4a_n + 2\ (n \geq 1)\\)을 변형하면, \\(3a_{n + 1} - 2 = (3a_n - 2)^2\\)가 되므로, 다음의 식이 성립합니다.

\\[3a_{3334} - 2 = (3a_1 - 2)^{2^{3333}} = 10000^{2^{3333}} = 10^{2^{3335}}\\]

따라서

\\[a_{3334} = \frac{10^{2^{3335}} + 2}{3}\\]

이 되며, 이는 제일 높은 자리부터 \\(2^{3335} - 1\\)개 만큼 \\(3\\)이 등장하고, 남은 1자리만 \\(4\\)인 양의 정수입니다.

따라서

\\[M = 3 \times (2^{3335} - 1) + 4 = 3 \times 2^{3335} + 1\\]

임을 알 수 있습니다.  
이는 페르마의 소정리를 이용해

\\[M = 3 \times 2^5 + 1 = 97\ (\mathrm{mod}\ 3331)\\]

로 계산할 수 있습니다.

### G


**문제**

두 개의 원 \\(\Gamma_1, \Gamma_2\\)가 있고, \\(\Gamma_1\\)은 \\(\Gamma_2\\)와 점 \\(X\\)에서 내접하고 있습니다.  
또한, \\(\Gamma_1\\) 위의 \\(X\\)가 아닌 점 \\(Y\\)에서, \\(\Gamma_1\\)의 점 \\(Y\\)에 대한 접선과 \\(\Gamma_2\\)가 서로 다른 두 점 \\(P, Q\\)에서 만났습니다.

\\[XP = 20, XQ = 23\\]

이 성립하고, \\(\Gamma_1\\)의 반지름과 \\(\Gamma_2\\)의 반지름의 비가 \\(4 : 9\\)일 때, 선분 \\(XY\\)의 길이의 제곱을 구하세요.

단, 구하려는 값은 서로소인 두 양의 정수 \\(a, b\\)를 이용해 \\(\frac{a}{b}\\)로 나타내어지므로, \\(a + b\\)의 값을 제출해주세요.

**해설**

> **보제:** 직선 \\(XY\\)는 \\(\angle{PXQ}\\)의 이등분선이다.
>
> **증명:** \\(\Gamma_1, \Gamma_2\\)의 중심을 각각 \\(O_1, O_2\\)라고 합시다.  
> 이 때, \\(X\\)를 중심으로 \\(\Gamma_1\\)을 \\(\Gamma_2\\)로 옮겨 확대하면 \\(Y\\)는 \\(R\\)이, \\(O_1\\)은 \\(O_2\\)로 각각 옮겨집니다.  
> 특히 직선 \\(YO_1\\)과 \\(RO_2\\)는 평행하게 되며, \\(YO\_1\\)과 \\(PQ\\)가 수직인 것으로부터, \\(RO_2\\)는 \\(PQ\\)에 수직이 됩니다.  
> 이로 인해 \\(PR = QR\\)이 성립하므로, \\(\angle{PXY} = \angle{QXY}\\)임을 보였습니다.

보제로부터, \\(PX : QY = 20 : 23\\)이 되므로, \\(PY = 20x, QY = 23x\\)라 둡시다.  
여기서, \\(XY : YR = 4 : 5\\)인 것으로부터, 방멱 정리에 의해

\\[XY \times YR = PY \times QY = 460x^2\\]

가 성립하는 동시에, \\(XY^2 = 368x^2\\)임을 알 수 있습니다.  
또한 스튜어트 정리에 의해

\\[XY^2 = XP \times XQ - PY \times QY = 460 - 460x^2\\]

이 성립하므로, 이를 이용해 \\(x^2 = \frac{5}{9}\\)임을 구할 수 있습니다.  
따라서, \\(XY^2 = \frac{1840}{9}\\)이므로 구하는 답은 \\(1849\\)입니다.

### H

**문제**

방향을 고정한 \\(333\\)각형의 각각의 정점을 빨강, 파랑, 초록의 세 가지 색 중 하나를 골라 칠하고, 칠한 방법에 따라 다음과 같이 점수를 매깁니다:

- 정 \\(333\\)각형의 변 중 양 끝의 정점의 색이 같은 것의 수

회전해서 같아지는 색칠 방법을 별개의 것으로 보는 \\(3^{333}\\)개의 모든 경우에 대해서, 각각의 점수의 제곱의 (산술)평균을 구하세요.

**해설**

일반적으로 정 \\(N\\)각형(\\(N\\)은 \\(3\\)이상의 정수)에 대해 생각해봅시다.  
정 \\(N\\)각형의 정점을 순서대로 \\(A_1, A_2, .., A_N\\)이라고 두고, 정점 \\(A_N\\) 다음엔 정점 \\(A_1\\)이 온다고 생각합시다. 또한, 정점 \\(A_i\\)에 칠해진 색은 \\(C_I\\)라고 합시다.

다음과 같이 점수의 제곱의 총합을 구해봅시다. 여기서,

\\[\begin{align}(점수의\ 제곱) &= (C_i = C_{i + 1}인\ i의\ 개수)^2 \nonumber\\&= (C_i = C_{i + 1}인\ i의\ 개수) \times (C_j = C_{j + 1}인\ j의\ 개수)\nonumber\end{align}\\]

인 것에 의해, 두 개의 번으로 구성된 쌍 각각이 관여하는 정도에 대해 생각하면 됩니다.

1) \\(i = j\\)일 때  
\\(i = j\\)를 고르는 방법은 \\(N\\)개, \\(C_i = C_{i + 1}\\)을 고르는 방법은 \\(3\\)개, 다른 색을 고르는 방법은 \\(3^{N - 2}\\)개 있으므로,

\\[N \times 3 \times 3^{N - 2} = 3N \times 3^{N - 2}\\]

2) \\(\vert i - j \vert = 1\\)일 때  
\\(i, j\\)를 고르는 방법은 \\(2N\\)개, \\(C_{\min(i,j)} = C_{\min(i,j) + 1} = C_{\min(i,j) + 2}\\)을 고르는 방법은 \\(3\\)개, 다른 색을 고르는 방법은 \\(3^{N - 3}\\)개 있으므로,

\\[2N \times 3 \times 3^{N - 3} = 2N \times 3^{N - 2}\\]

3) \\(\vert i - j \vert \geq 2\\)일 때  
\\(i, j\\)를 고르는 방법은 \\(N(N - 3)\\)개, \\(C_i = C_{i + 1}, C_j = C_{j + 1}\\)을 고르는 방법은 \\(3^2\\)개, 다른 색을 고르는 방법은 \\(3^{N - 4}\\)개 있으므로,

\\[N(N - 3) \times 3^2 \times 3^{N - 4} = N(N - 3) \times 3^{N - 2}\\]


**1, 2, 3**에 의해 점수의 제곱의 합은

\\[3N \times 3^{N - 2} + 2N \times 3^{N - 2} + N(N - 3) \times 3^{N - 2} = N(N + 2) \times 3^{N - 2}\\]

따라서, 평균은 \\(\frac{N(N + 2)}{9}\\)가 되며, \\(N = 333\\)일 때 \\(12395\\)가 됩니다.